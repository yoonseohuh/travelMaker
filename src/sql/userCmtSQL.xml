<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="userCmt">

<!-- groupMember테이블에서 사용자가 참여중인거 DTO가져오기 -->
<select id="myGroup" parameterType="string" resultType="GroupMemberDTO">
	select * from GroupMember where id=#{id} and status=1
</select>

<!-- 그룹고유번호에 맞는 그룹정보 가져오기 -->
<select id="getGroupInfo" parameterType="int" resultType="GroupSpaceDTO">
	select * from GroupSpace where gNo=#{num}
</select>

<select id="getMem" parameterType="int" resultType="GroupMemberDTO">
	select * from groupMember where gNo=#{gNo} and status=1
</select>

<!-- comment 남겼는지 확인 -->
<select id="chcomment" parameterType="Hashmap" resultType="int">
	select count(*) from userCmt where receiver=#{recId} and sender=#{senId} and gNo=#{gNo}
</select>


<!-- 코멘트 넣기 -->
<insert id="insertCom" parameterType="Hashmap">
	insert into userCmt values(#{gNo}, comment_seq.nextval, #{recId}, #{senId}, #{comment}, 0, sysdate)
</insert>

<!-- 사용자 여행그룹 갯수 -->
<select id="countGroup" parameterType="String" resultType="int">
	select count(*) from groupMember where id=#{id}
</select>

<!-- 코멘트DTO가져오기 받는사람 : 사용자일떄-->
<select id="comRecUser" parameterType="Hashmap" resultType="UserCmtDTO">
	select * from userCmt where receiver=#{id} and status=0
</select>

<!-- 코멘트DTO가져오기 보낸사람 : 사용자일떄-->
<select id="comSenUser" parameterType="Hashmap" resultType="UserCmtDTO">
	select * from userCmt where sender=#{id} and status=0
</select>

<!-- 여행가져오기 -->
<select id="selectGroupMem" parameterType="int" resultType="GroupMemberDTO">
	select * from groupmember where gNo=#{groupNum}
</select>


</mapper>