<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="tmUser">

	<insert id="insertMember" parameterType="TmUserDTO">
		insert into tmUser (id,pw,name,nickname,birth,email,gender,reg)  values (#{id},#{pw},#{name},#{nickname},#{birth},#{email},#{gender},sysdate)
	</insert>
	
	<select id="idPwCheck" parameterType="TmUserDTO" resultType="int">
		select count(*) from tmUser where id=#{id} and pw=#{pw}
	</select>
	
	<select id="emailCheck" parameterType="string" resultType="int">
		select count(*) from tmUser where email=#{email}
	</select>
	
	<select id="getMemInfo" parameterType="string" resultType="TmUserDTO">
		select * from tmUser where email=#{email}
	</select>
	
	<select id="idEmailCheck" parameterType="TmUserDTO" resultType="int">
		select count(*) from tmUser where id=#{id} and email=#{email}
	</select>
	
	<update id="pwChange" parameterType="TmUserDTO">
		update tmUser set pw=#{pw} where id=#{id}
	</update>	

	<select id="getMember" parameterType="string" resultType="TmUserDTO">
		select * from tmUser where id=#{id}
	</select>

	<select id="getGender" parameterType="string" resultType="int">
		select gender from tmUser where id=#{id}
	</select>
	
	<update id="updaNick" parameterType="string">
		update tmUser set nickname=#{nickname} where id=#{id}
	</update>	
	
	<update id="changeStat" parameterType="hashMap">
		update tmUser set status=#{status} where id=#{id}
	</update>
	
	<select id="getMembers" parameterType="hashMap" resultType="TmUserDTO">
		<![CDATA[
			select b.*, r from (select a.*,rownum r from
			(select * from tmUser order by reg desc)a
			order by reg desc)b where r>=#{start} AND r<=#{end}
		]]>
	</select>
	
	<select id="getSearchMembers" parameterType="hashMap" resultType="TmUserDTO">
		select * from tmUser where id=#{search}
	</select>
	
	<select id="getSearchMemberCount" parameterType="string" resultType="int">
		select count(*) from tmUser where id=#{search}
	</select>
	
	<select id="getMemberCount" resultType="int">
		select count(*) from tmUser 
	</select>
	
	
	
</mapper>